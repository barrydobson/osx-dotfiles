local profile
local region="us-east-1"

while getopts ':p:r:' arg; do
  case $arg in
    p) profile=${OPTARG};;
    r) region=${OPTARG};;
  esac
done

[[ -z "${profile}" ]] && \
  profile=$(cat ~/.aws/credentials | ag 'mlb-.*?(?=])' -o | fzf --no-multi)

cluster=$(eksctl get cluster --profile="${profile}" --region="${region}" \
  | cut -f1 \
  | fzf --no-multi --header-lines=1)

eksctl utils write-kubeconfig --name="${cluster}" --profile="${profile}" --region="${region}"
